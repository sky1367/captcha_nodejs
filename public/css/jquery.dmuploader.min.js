/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/dmuploader@1.0.4/jquery.dmuploader.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
!function(e){var t={url:document.URL,method:"POST",apiKey:!1,appId:!1,extraData:{},maxFileSize:0,maxFiles:0,allowedTypes:"*",extFilter:null,fileName:"file",onInit:function(e){},onFallbackMode:function(e){},onNewFile:function(e,t){},onBeforeUpload:function(e){},onComplete:function(){},onUploadProgress:function(e,t){},onUploadSuccess:function(e,t){},onUploadError:function(e,t){},onFileTypeError:function(e){},onFileSizeError:function(e){},onFileExtError:function(e){},onFilesMaxError:function(e){}},n=function(n,i){return this.element=e(n),this.settings=e.extend({},t,i),!!this.checkBrowser()&&(this.init(),!0)};n.prototype.checkBrowser=function(){return void 0===window.FormData?(this.settings.onFallbackMode.call(this.element,"Browser doesn't support Form API"),!1):this.element.find("input[type=file]").length>0||(!(!this.checkEvent("drop",this.element)||!this.checkEvent("dragstart",this.element))||(this.settings.onFallbackMode.call(this.element,"Browser doesn't support Ajax Drag and Drop"),!1))},n.prototype.checkEvent=function(e,t){var n=(e="on"+e)in(t=t||document.createElement("div"));return n||(t.setAttribute||(t=document.createElement("div")),t.setAttribute&&t.removeAttribute&&(t.setAttribute(e,""),n="function"==typeof t[e],void 0!==t[e]&&(t[e]=void 0),t.removeAttribute(e))),t=null,n},n.prototype.init=function(){var t=this;t.queue=new Array,t.queuePos=-1,t.queueRunning=!1,t.element.on("drop",function(e){e.preventDefault();var n=e.originalEvent.dataTransfer.files;t.queueFiles(n)}),t.element.find("input[type=file]").on("change",function(n){var i=n.target.files;t.queueFiles(i),e(this).val("")}),this.settings.onInit.call(this.element,this)},n.prototype.queueFiles=function(t){for(var n=this.queue.length,i=0;i<t.length;i++){var o=t[i];if(this.settings.maxFileSize>0&&o.size>this.settings.maxFileSize)this.settings.onFileSizeError.call(this.element,o);else if("*"==this.settings.allowedTypes||o.type.match(this.settings.allowedTypes)){if(null!=this.settings.extFilter){var s=this.settings.extFilter.toLowerCase().split(";"),u=o.name.toLowerCase().split(".").pop();if(e.inArray(u,s)<0){this.settings.onFileExtError.call(this.element,o);continue}}if(this.settings.maxFiles>0&&this.queue.length>=this.settings.maxFiles)this.settings.onFilesMaxError.call(this.element,o);else{this.queue.push(o);var r=this.queue.length-1;this.settings.onNewFile.call(this.element,r,o)}}else this.settings.onFileTypeError.call(this.element,o)}return this.queue.length!=n},n.prototype.startUpload=function(e){if(this.queueRunning)return!1;this.queueRunning=!0,this.processQueue(e)},n.prototype.removeQueue=function(e){return(!this.queueRunning||e!==this.queuePos)&&(this.queue.splice(e,1),!0)},n.prototype.processQueue=function(t){var n=this;if(n.queueRunning=!0,"all"===t){if(n.queuePos++,n.queuePos>=n.queue.length)return n.settings.onComplete.call(n.element),n.queuePos=n.queue.length-1,void(n.queueRunning=!1)}else n.queuePos=t;var i=n.queue[n.queuePos],o=new FormData;if(o.append(n.settings.fileName,i),!1===n.settings.onBeforeUpload.call(n.element,n.queuePos))return n.queuePos="all"===t?n.queue.length-1:-1,void(n.queueRunning=!1);e.each(n.settings.extraData,function(e,t){o.append(e,t)});var s=n.genFileName(i.type),u=n.settings.url+s;void 0!==i.uploadURL&&(u=i.uploadURL),e.ajax({url:u,type:n.settings.method,beforeSend:function(e){n.settings.appId&&e.setRequestHeader("X-Parse-Application-Id",n.settings.appId),n.settings.apiKey&&e.setRequestHeader("X-Parse-REST-API-Key",n.settings.apiKey),e.setRequestHeader("Content-Type",i.type)},data:i,cache:!1,contentType:!1,processData:!1,forceSync:!1,xhr:function(){var t=e.ajaxSettings.xhr();return t.upload&&t.upload.addEventListener("progress",function(e){var t=0,i=e.loaded||e.position,o=e.total||e.totalSize;e.lengthComputable&&(t=Math.ceil(i/o*100)),n.settings.onUploadProgress.call(n.element,n.queuePos,t)},!1),t},success:function(e,t,i){n.settings.onUploadSuccess.call(n.element,n.queuePos,e)},error:function(e,t,i){n.settings.onUploadError.call(n.element,n.queuePos,i)},complete:function(e,i){"all"!==t?(n.queueRunning=!1,n.settings.onComplete.call(n.element)):(n.queueRunning=!1,n.processQueue(t))}})},n.prototype.genFileName=function(e){var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)});return"image/gif"===e&&(t+=".gif"),"image/jpeg"===e&&(t+=".jpg"),"image/png"===e&&(t+=".png"),"image/tiff"===e&&(t+=".tiff"),"image/x-icon"===e&&(t+=".ico"),"audio/mpeg"===e&&(t+=".mp3"),"audio/mp3"===e&&(t+=".mp3"),t},e.fn.dmUploader=function(t){return this.each(function(){e.data(this,"dmUploader")||e.data(this,"dmUploader",new n(this,t))})},e(document).on("dragenter",function(e){e.stopPropagation(),e.preventDefault()}),e(document).on("dragover",function(e){e.stopPropagation(),e.preventDefault()}),e(document).on("drop",function(e){e.stopPropagation(),e.preventDefault()})}(jQuery);
//# sourceMappingURL=/sm/86f8ce050f88eca05b6d851bb8772f3741dfe9774b76077754774c0114c89f14.map